% rayleigh.m
% ²úÉúÈðÀûË¥Âä

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function rayleigh=rayleigh(fd,T)
	N=5;
    n1=4*N+2;
    a1=sqrt(2/(n1+1));
    a2=1/sqrt(n1+1);
    a3=sqrt(2/n1);
    t=T;
    b1=0;
    b2=cos(2*pi*fd*t);
    b3=0;
    for i=1:n1
        b1=b1+cos(pi*i/n1)*cos(2*pi*fd*cos(2*pi*i/n1)*t);
    end
    for i=1:n1
        b3=b3+sin(pi*i/n1)*cos(2*pi*fd*cos(2*pi*i/n1)*t);
    end
%     a2*b2
   rayleigh=a1*b1+a2*b2+j*a3*b3;
%     rayleigh=sqrt((a1*b1+a2*b2)^2+(a3*b3)^2);





%==========================================================================
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%--------------------------------------------------------------------------